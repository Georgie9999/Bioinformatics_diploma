# Bioinformatics_diploma
Применение методов машинного обучения для предсказания влияния небольших молекул на экспрессию генов

## Ссылка на соревнование:
https://www.kaggle.com/competitions/open-problems-single-cell-perturbations
## Ccылка на Google Colab:
https://colab.research.google.com/drive/1kuZm4_W3N8g781L2-pOZTDHXC5NgSw2b?usp=sharing - обучение модели

## Ссылка на презентацию
https://docs.google.com/presentation/d/1_Mvm-OIJMhYlKo04IrS3u_XaQS7Y1if_/edit#slide=id.p1


### Описание задачи с Kaggle:

#### Обзор
Цель этого конкурса - предсказать, как маленькие молекулы изменяют экспрессию генов в различных типах клеток.

Ваша работа поможет разработать методы прогнозирования того, как клетки реагируют на возмущения низкомолекулярных
лекарственных средств, которые могут иметь важное применение в разработке лекарств и фундаментальной биологии.

#### Оценка решения:
Для оцекни решения рассчитывается среднеквадратичная ошибка по строкам:

$$ MRRMSE = \frac{1}{R}\sum_{i = 1}^{R}(\frac{1}{n}\sum_{j = 1}^{n}(y_{ij} - \hat{y_{ij}})^2)^{\frac{1}{2}} $$

#### Отправка решения
Для каждого id из оценочного набора нужно спрогнозировать значение для каждого из 18 211 генов, названных в остальных столбцах.
Каждый id соответствует паре cell_type/ sm_name, которую можно из id_map.csv файла

#### Данные
- de_train.parquet - основной набор данных; предсказать нам надо 18211 генов, 
а первые 5 переменных - описание клеток
- id_map.csv - столбцы с cell_type и sm_name, т.е. типом клетки и названием лекарственного соединения

#### Описание данных
- Гены A1BG, A1BG-AS1, …, ZZEF1(всего 18 211) - Значение дифференциальной экспрессии (-log10(p-value) * sign(LFC)) для каждого гена.
Здесь LFC представляет собой предполагаемое логарифмическое изменение экспрессии между обработанным и контрольным состоянием после усадки, рассчитанное Лиммой.
Положительный LFC означает, что уровень гена повышается в условиях лечения по сравнению с контролем.
- cell_type- Аннотированный тип каждой клетки на основе экспрессии РНК.
- sm_name- Основное имя (родительского) соединения (в стандартизированном представлении), выбранное LINCS.
Это предусмотрено для сопоставления данных этого эксперимента с данными карты связности LINCS.
Это и есть лекарственное соединение, которое действует на клетку (каждая из которых имеет тип cell_type)
- sm_lincs_id- Глобальный идентификатор LINCS ID (родительского) соединения (в стандартизированном представлении).
Это предусмотрено для сопоставления данных этого эксперимента с данными карты связности LINCS.
- SMILES- Упрощенная система молекулярного ввода (SMILES) представляет соединения, использованные в эксперименте.
Это одномерное представление молекулярной структуры. Эти SMILES предоставлены Cellarity на основе конкретных соединений, заказанных для этого эксперимента.
- control — Логическое значение, указывающее, использовался ли этот экземпляр в качестве элемента управления.

#### Predict
- предсказывать нужно по переменным cell_type и sm_name (по типу клетки и по лекарству, которое воздействовала на клетку)
Предсказывть нужно по тестовой выборке (id_map.csv), где и представлены эти 2 переменные 
- предсказать нужно не 1 переменную, а 18211 переменных - поэтому
  юзаем MultiOutputRegressor и в качестве аргумента подаем туда любимую модель
- не знаю почему, но метод опорных векторов сработал довольно быстро в отличие от деревьев
- пользуемся MultiOutputRegressor и предсказываем 18211 генов по датасету id_map.csv
